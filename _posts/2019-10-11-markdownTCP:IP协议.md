---
layout: post
title: TCP/IP协议
tags: 基础
stickie: true
---

# TCP/IP协议

## 一、什么是TCP/IP？

### TCP/IP是一类协议系统，它是用于网络通信的一套协议集合

####传统上来说TCP/IP被认为是一个四层协议

![tcp/ip](/Users/lexiaofeng/Desktop/lexiaofeng.github.io/img/1.png)

#####1)网络接口层：

主要是指物理层次的一些接口，比如电缆等

#####2）网络层：

提供独立于硬件的逻辑寻址，实现物理地址与逻辑地址的转换

在TCP/IP协议族中，网络层协议包括IP协议（网际协议），ICMP协议（Internet互联网控制报文协议），以及IGMP协议（Internet组管理协议）

#####3）传输层：

为网络提供了流量控制，错误控制和确认服务。

在TCP/IP协议族中有两个互不相同的传输协议：TCP（传输控制协议）和UDP（用户数据报协议）。

##### 4）应用层：

为网络排错，文件传输，远程控制和internet 操作提供具体的应用程序。

## 二、数据包

**在 TCP / IP 协议中数据先由上往下将数据装包，然后由下往上拆包**

**在装包的时候，每一层都会增加一些信息用于传输，这部分信息就叫报头，当上层的数据到达本层的时候，会将数据加上本层的报头打包在一起，继续往下传递．**

![2](/Users/lexiaofeng/Desktop/lexiaofeng.github.io/img/2.jpg)

**在拆包的时候，每一层将本层需要的报头读取后，就将剩下的数据往上传．**

## 三、网络接口层

**这一块主要主要涉及到一些物理传输，比如以太网，无线局域网．这里就不做详细的介绍了**

## 四、网络层

**前面有提到，网络层主要就是做物理地址与逻辑地址之间的转换**

**目前市场上应用的最多的是 32 位二进制的 IPv4 ,因为 IPv4 的地址已经不够用了，所以 128 位二进制的 IPv6 应用越来越广泛了(但是下面的介绍都是基于 IPv4 进行的)**

### 1) IP:

**TCP/IP 协议网络上的每一个网络适配器都有一个唯一的 IP 地址.**

**IP 地址是一个 32 位的地址,这个地址通常分成 4 端，每 8 个二进制为一段，但是为了方便阅读，通常会将每段都转换为十进制来显示，比如大家非常熟悉的 192.168.0.1**

**IP 地址分为两个部分：**

- **网络 ID**
- **主机 ID**

**但是具体哪部分属于网络 ID,哪些属于主机 ID 并没有规定.**

**因为有些网络是需要很多主机的，这样的话代表主机 ID 的部分就要更多，但是有些网络需要的主机很少，这样主机 ID 的部分就应该少一些.**

**绝大部分 IP 地址属于以下几类**

- **A 类地址：IP 地址的前 8 位代表网络 ID ，后 24 位代表主机 ID。**
- **B 类地址：IP 地址的前 16 位代表网络 ID ，后 16 位代表主机 ID。**
- **C 类地址：IP 地址的前 24 位代表网络 ID ，后 8 位代表主机 ID。**

**这里能够很明显的看出 A 类地址能够提供出的网络 ID 较少，但是每个网络可以拥有非常多的主机**

**但是我们怎么才能看出一个 IP 地址到底是哪类地址呢？**

- **如果 32 位的 IP 地址以 0 开头，那么它就是一个 A 类地址。**
- **如果 32 位的 IP 地址以 10 开头，那么它就是一个 B 类地址。**
- **如果 32 位的 IP 地址以 110 开头，那么它就是一个 C 类地址。**

**那么转化为十进制（四段）的话，我们就能以第一段中的十进制数来区分 IP 地址到底是哪类地址了。**

![](/Users/lexiaofeng/Desktop/lexiaofeng.github.io/img/3.jpg.png)

### 注意：

- **十进制第一段大于 223 的属于 D 类和 E 类地址，这两类比较特殊也不常见，这里就不做详解介绍了。**
- **每一类都有一些排除地址，这些地址并不属于该类，他们是在一些特殊情况使用地址（后面会介绍）**
- **除了这样的方式来划分网络，我们还可以把每个网络划分为更小的网络块，称之为子网（后面会介绍）**

**全是 0 的主机 ID 代表网络本身，比如说 IP 地址为 130.100.0.0 指的是网络 ID 为130.100 的 B 类地址。**

**全是 1 的主机 ID 代表广播，是用于向该网络中的全部主机方法消息的。 IP 地址为 130.100.255.255 就是网络 ID 为 130.100 网络的广播地址（二进制 IP 地址中全是 1 ，转换为十进制就是 255 ）**

**以十进制 127 开头的地址都是环回地址。目的地址是环回地址的消息，其实是由本地发送和接收的。主要是用于测试 TCP/IP 软件是否正常工作。我们用 ping 功能的时候，一般用的环回地址是 127.0.0.1**

### 2)地址解析协议 ARP

**简单的来说 ARP 的作用就是把 IP 地址映射为物理地址，而与之相反的 RARP（逆向 ARP）就是将物理地址映射为 IP 地址。**

### 3)子网

**前面提到了 IP 地址的分类，但是对于 A 类和 B 类地址来说，每个网络下的主机数量太多了，那么网络的传输会变得很低效，并且很不灵活。比如说 IP地址为 100.0.0.0 的 A 类地址，这个网络下的主机数量超过了 1600 万台。**

**所以子网掩码的出现就是为了解决这样的问题。**

##五、传输层

**传输层提供了两种到达目标网络的方式**

- **传输控制协议（TCP）：提供了完善的错误控制和流量控制，能够确保数据正常传输，是一个面向连接的协议。**
- **用户数据报协议（UDP）：只提供了基本的错误检测，是一个无连接的协议。**

### 特点：

### 1）UDP：适合视频数据

- 把数据打包
- 数据大小有限制（64k）
- 不建立连接
- 速度快，但可靠性低

### 2）TCP：适合文字数据

- 建立连接通道
- 数据大小无限制
- 速度慢，但是可靠性高

## 六、应用层

**应用层做为 TCP/IP 协议的最高层级，对于我们移动开发来说，是接触最多的。**

#### 运行在TCP协议上的协议：

- HTTP（Hypertext Transfer Protocol，超文本传输协议），主要用于普通浏览。

- HTTPS（Hypertext Transfer Protocol over Secure Socket Layer, or HTTP over SSL，安全超文本传输协议）,HTTP协议的安全版本。

- FTP（File Transfer Protocol，文件传输协议），由名知义，用于文件传输。

- POP3（Post Office Protocol, version 3，邮局协议），收邮件用。

- SMTP（Simple Mail Transfer Protocol，简单邮件传输协议），用来发送电子邮件。

- TELNET（Teletype over the Network，网络电传），通过一个终端（terminal）登陆到网络。

- SSH（Secure Shell，用于替代安全性差的TELNET），用于加密安全登陆用。

  #### 运行在UDP协议上的协议：

- BOOTP（Boot Protocol，启动协议），应用于无盘设备。

- NTP（Network Time Protocol，网络时间协议），用于网络同步。

- DHCP（Dynamic Host Configuration Protocol，动态主机配置协议），动态配置IP地址。

  #### 其他：

- DNS（Domain Name Service，域名服务），用于完成地址查找，邮件转发等工作（运行在TCP和UDP协议上）。

- ECHO（Echo Protocol，回绕协议），用于查错及测量应答时间（运行在TCP和UDP协议上）。

- SNMP（Simple Network Management Protocol，简单网络管理协议），用于网络信息的收集和网络管理。

- ARP（Address Resolution Protocol，地址解析协议），用于动态解析以太网硬件的地址。



